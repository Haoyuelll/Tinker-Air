<launch>
    <!-- static map -->
    <arg name="cartographer_arguments" default="" />
    <arg name="load_static_map" default="" />
    <arg name="load_map_locations" default="" />

    <group if="$(arg load_static_map)">
        <arg name="cartographer_arguments" value="-load_state_filename $(arg load_static_map)" />
    </group>
    <group if="$(arg load_map_locations)">
        <include file="$(find tinker_navigation)/launch/map_locations/$(arg load_map_locations)" />
    </group>

    <!-- urdf description -->
    <include file="$(find tinker_description)/launch/publish_urdf.launch" />

    <!-- lidars -->
    <node name="urg_front" pkg="urg_node" type="urg_node" output="screen" respawn="true" >
        <param name="serial_port" type="str" value="/dev/hokuyo_front"/>

        <remap from="/scan" to="/urg_scan_front" />
        <param name="frame_id" type="str" value="urg_laser_front" />

        <!-- UTM-30LX parameters (No Intensity Mode) -->
        <!-- http://wiki.ros.org/urg_node -->
        <param name="cluster" value="1" />
        <param name="skip" value="1" />
        <param name="publish_intensity" value="false" />
        <!-- Only use front face 180 deg (not occuluded) -->
        <param name="angle_min" value="-1.5707963" />
        <param name="angle_max" value="1.5707963" />
    </node>

    <!-- cartographer -->
    <!-- ref: https://readthedocs.org/projects/google-cartographer-ros/downloads/pdf/latest/ -->
    <node name="cartographer_node" pkg="cartographer_ros"
        type="cartographer_node" args="
            -configuration_directory $(find tinker_navigation)/config/slam
            -configuration_basename backpack_2d.lua
            $(arg cartographer_arguments)"
        output="screen" respawn="true">
        <remap from="/scan" to="/urg_scan_front" />
    </node>

    <node name="cartographer_occupancy_grid_node" pkg="cartographer_ros"
        type="cartographer_occupancy_grid_node" args="-resolution 0.05"
        output="screen" respawn="true"/>
</launch>